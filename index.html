<!DOCTYPE html>
<html lang="en-IE" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MMM Drone Services — Live Order Board</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00ff95; 
            --dark: #0a0f1a;
            --text: #ffffff;
            --card-bg: rgba(30, 41, 59, 0.9);
        }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Montserrat', sans-serif; }
        body { background: var(--dark); color: var(--text); line-height: 1.4; }
        
        /* Loading Overlay Fix */
        #app-loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--dark); display: flex; align-items: center;
            justify-content: center; z-index: 9999; transition: opacity 0.5s;
        }

        nav {
            padding: 1rem 5%; display: flex; justify-content: space-between;
            align-items: center; position: fixed; width: 100%; top: 0; z-index: 1000;
            background: rgba(10, 15, 26, 0.9); backdrop-filter: blur(10px);
        }
        .logo-img { height: 40px; filter: invert(1); } /* Makes black logo white for dark theme */

        .hero {
            height: 100vh; display: flex; align-items: center; justify-content: center;
            text-align: center; background: linear-gradient(rgba(10,15,26,0.8), rgba(10,15,26,0.8)),
            url('https://images.unsplash.com/photo-1473960103865-8673b53e923e?auto=format&fit=crop&w=1920&q=80');
            background-size: cover; padding: 0 5%;
        }
        h1 { font-weight: 900; font-size: clamp(2.5rem, 8vw, 5rem); text-transform: uppercase; margin-bottom: 1rem; }
        .btn { padding: 1.2rem 2rem; border-radius: 0.5rem; border: none; font-weight: 900; text-transform: uppercase; cursor: pointer; text-decoration: none; }
        .btn-primary { background: var(--primary); color: var(--dark); }

        section { padding: 6rem 10%; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; }
        .card { background: var(--card-bg); padding: 2.5rem; border-radius: 1rem; border: 1px solid rgba(255,255,255,0.1); }
        
        .board-wrapper { overflow-x: auto; padding-bottom: 1rem; }
        .board { display: flex; gap: 1rem; min-width: 900px; }
        .column { flex: 1; background: rgba(255,255,255,0.05); border-radius: 1rem; padding: 1.5rem; min-height: 400px; }
        .order-card { background: #000; padding: 1rem; border-radius: 0.5rem; margin-top: 1rem; border-left: 4px solid var(--primary); }
    </style>
</head>
<body>

    <div id="app-loader">
        <h2 style="color: var(--primary); font-weight: 900;">INITIALIZING DRONE NETWORK...</h2>
    </div>

    <nav>
        <div style="display: flex; align-items: center; gap: 15px;">
            <div style="font-weight: 900; letter-spacing: -1px;">MMM PLATFORMS</div>
        </div>
        <div style="font-size: 0.7rem; font-weight: 700; text-align: right;">
            1ST CLASS SERVICES<br><span style="color: var(--primary);">ZERO EMISSIONS</span>
        </div>
    </nav>

    <section class="hero">
        <div>
            <h1>MMM Drone<br>Services</h1>
            <p style="font-weight: 700; margin-bottom: 2rem; font-size: 1.2rem;">Live Order Board — Cape Town & Johannesburg</p>
            <button class="btn btn-primary" onclick="window.orderFlow.place()">Create Live Mission</button>
        </div>
    </section>

    <section id="board">
        <h2 style="font-weight: 900; margin-bottom: 2rem; text-transform: uppercase;">Real-Time Flight Board</h2>
        <div class="board-wrapper">
            <div class="board">
                <div class="column"><h3>NEW</h3><div id="list-New"></div></div>
                <div class="column"><h3>IN FLIGHT</h3><div id="list-InFlight"></div></div>
                <div class="column"><h3>DELIVERED</h3><div id="list-Delivered"></div></div>
            </div>
        </div>
    </section>

    <footer style="text-align: center; padding: 4rem; background: #000; border-top: 2px solid var(--primary);">
        <p style="font-weight: 900;">© MMM Platforms - Mzwandile Hlophe</p>
        <p style="font-size: 0.8rem; opacity: 0.6; margin-top: 10px;">Download MMM Platforms App on Google Play & App Store</p>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Your Exact Config
        const firebaseConfig = {
            apiKey: "AIzaSyA42AEfO6mGGSTKa-2QcR9hFEj3xBhRuoc",
            authDomain: "live-order-board-ab721.firebaseapp.com",
            projectId: "live-order-board-ab721",
            storageBucket: "live-order-board-ab721.firebasestorage.app",
            messagingSenderId: "157405136208",
            appId: "1:157405136208:web:074c852dbae6a46a305855"
        };

        try {
            const app = initializeApp(firebaseConfig);
            const db = getFirestore(app);

            // Hide loader once Firebase connects
            document.getElementById('app-loader').style.opacity = '0';
            setTimeout(() => document.getElementById('app-loader').style.display = 'none', 500);

            // Global Order Placement
            window.orderFlow = {
                async place() {
                    const client = prompt("Enter Client/Farm Name:");
                    const type = prompt("Service Type (Agri / Courier):");
                    if(!client || !type) return;
                    await addDoc(collection(db, "orders"), {
                        client, type, status: 'New', timestamp: new Date().getTime()
                    });
                }
            };

            // Real-time synchronization
            const q = query(collection(db, "orders"), orderBy("timestamp", "desc"));
            onSnapshot(q, (snapshot) => {
                // Clear all lists
                document.getElementById('list-New').innerHTML = '';
                document.getElementById('list-InFlight').innerHTML = '';
                document.getElementById('list-Delivered').innerHTML = '';
                
                snapshot.forEach((doc) => {
                    const data = doc.data();
                    const card = document.createElement('div');
                    card.className = 'order-card';
                    card.innerHTML = `<strong>${data.client}</strong><br><small>${data.type}</small>`;
                    
                    const targetList = document.getElementById(`list-${data.status}`);
                    if(targetList) targetList.appendChild(card);
                });
            });

        } catch (error) {
            console.error("Firebase Initialization Failed:", error);
            document.getElementById('app-loader').innerHTML = "<h2>Connection Error. Please check your internet.</h2>";
        }
    </script>
</body>
</html>
